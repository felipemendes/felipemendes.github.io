{"componentChunkName":"component---src-templates-blog-post-js","path":"/generics/","result":{"data":{"site":{"siteMetadata":{"title":"Felipe Mendes"}},"markdownRemark":{"id":"47a1ce81-ce1d-528d-860f-6fe11f99a83f","excerpt":"Nesta postagem abordo o que são códigos genéricos e qual a utilidade na rotina de um desenvolvedor Swift. O que são códigos genéricos? A melhor definição de…","html":"<p>Nesta postagem abordo o que são códigos genéricos e qual a utilidade na rotina de um desenvolvedor Swift.</p>\n<h2>O que são códigos genéricos?</h2>\n<p>A melhor definição de genéricos (ou <code class=\"language-text\">generics</code>) é a que encontramos no nosso dicionário: <strong>Que abarca muitas coisas gerais (ao mesmo tempo)</strong>. Em programação, o conceito não é diferente. <code class=\"language-text\">Generic</code> é utilizado para escrever funções e tipos flexíveis e reutilizáveis que pode funcionar com qualquer tipo, sujeito aos requisitos definidos.</p>\n<p>Essa abordagem permite escrever código onde os tipos são especificados posteriormente, quando são instanciados. O maior benefício é reduzir a duplicação e expressar sua intenção de maneira clara e abstrata.</p>\n<p>Deste modo, ao invés de criar uma função ou bloco de código que atenda cada tipo, como <code class=\"language-text\">String</code> ou <code class=\"language-text\">Int</code>, podemos especificar um tipo genérico que atenda qualquer situação. Assim deixamos a própria linguagem inferir o tipo com base no valor informado. O termo <code class=\"language-text\">Generic</code> também pode ser conhecido como tipo <code class=\"language-text\">placeholder</code>.</p>\n<p><code class=\"language-text\">Swift</code> é considerada uma linguagem <code class=\"language-text\">type-safe</code>. Isso significa que, <strong>o tipo deve ser definido antes da compilação</strong>. Por esse motivo, todo tipo deve ser definido.</p>\n<h2>Criando código genérico</h2>\n<p>Uma função genérica em Swift possui um tipo reservado (um <code class=\"language-text\">placeholder</code>) antes de seu nome e entre sinais menor e maior. Dessa forma: <code class=\"language-text\">&lt;Tipo></code>.</p>\n<p>Os parâmetros também devem receber o mesmo tipo reservado.</p>\n<p>Este tipo reservado, normalmente, é identificado pelas letras <code class=\"language-text\">T</code>, <code class=\"language-text\">U</code>, <code class=\"language-text\">V</code> e entre outras.</p>\n<h2>Entendendo com exemplos</h2>\n<p>Utilizando o exemplo clássico, vamos supor que precisamos trocar dois valores numéricos, entre <code class=\"language-text\">a</code> e <code class=\"language-text\">b</code>. Para reproduzir a criação dessa função, devemos receber dois parâmetros do tipo inteiro. Especificando o tipo <code class=\"language-text\">Int</code> teríamos algo como:</p>\n<div class=\"gatsby-highlight\" data-language=\"swift\"><pre class=\"language-swift\"><code class=\"language-swift\"><span class=\"token keyword\">func</span> <span class=\"token function-definition function\">swapTwoInts</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">:</span> <span class=\"token class-name\">Int</span><span class=\"token punctuation\">,</span> b<span class=\"token punctuation\">:</span> <span class=\"token class-name\">Int</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-></span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">Int</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">Int</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>b<span class=\"token punctuation\">,</span> a<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token function\">swapTwoInts</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> b<span class=\"token punctuation\">:</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token comment\">// (2, 1)</span></code></pre></div>\n<p>Agora vamos supor que seja necessário trocar dois números de ponto flutuante (<code class=\"language-text\">Double</code>) ou mesmo textos (<code class=\"language-text\">String</code>). Nesta situação, precisaríamos escrever outra função para esta tarefa, pois a função acima aceita apenas a entrada de números inteiros.</p>\n<p>Convertendo a mesma função para o tipo genérico, teríamos o código abaixo com o mesmo comportamento:</p>\n<div class=\"gatsby-highlight\" data-language=\"swift\"><pre class=\"language-swift\"><code class=\"language-swift\"><span class=\"token keyword\">func</span> <span class=\"token function-definition function\">swapTwoValues</span><span class=\"token operator\">&lt;</span><span class=\"token class-name\">T</span><span class=\"token operator\">></span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">:</span> <span class=\"token class-name\">T</span><span class=\"token punctuation\">,</span> b<span class=\"token punctuation\">:</span> <span class=\"token class-name\">T</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-></span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">T</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">T</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>b<span class=\"token punctuation\">,</span> a<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token function\">swapTwoValues</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">:</span> <span class=\"token number\">10.5</span><span class=\"token punctuation\">,</span> b<span class=\"token punctuation\">:</span> <span class=\"token number\">12.8</span><span class=\"token punctuation\">)</span>         <span class=\"token comment\">// (12.8, 10.5)</span>\n<span class=\"token function\">swapTwoValues</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">:</span> <span class=\"token string-literal\"><span class=\"token string\">\"Hello\"</span></span><span class=\"token punctuation\">,</span> b<span class=\"token punctuation\">:</span> <span class=\"token string-literal\"><span class=\"token string\">\"World\"</span></span><span class=\"token punctuation\">)</span>   <span class=\"token comment\">// (\"World\", \"Hello\")</span></code></pre></div>\n<p>Assim é possível trocar qualquer tipo de valor, não será necessário escrever outras funções para cada situação.</p>\n<blockquote>\n<p>Vale lembrar que não é possível informar tipos diferentes nos parâmetros ao invocar a mesma função genérica.</p>\n</blockquote>\n<h2>Restringindo o tipo genérico</h2>\n<p>Códigos genéricos também são muito utilizados para restringir instâncias somente para tipos de possuem alguma conformidade, com <code class=\"language-text\">class</code> ou <code class=\"language-text\">protocol</code>, por exemplo.</p>\n<h3>Conformidade com classe</h3>\n<p>No código a seguir, <code class=\"language-text\">T</code> está em conformidade com o tipo <code class=\"language-text\">BankAccount</code>. Portanto, não é possível invocar a função <code class=\"language-text\">displayBankAccount()</code> com nenhum outro valor que não seja do tipo <code class=\"language-text\">BankAccount</code>.</p>\n<div class=\"gatsby-highlight\" data-language=\"swift\"><pre class=\"language-swift\"><code class=\"language-swift\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">BankAccount</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">var</span> holder<span class=\"token punctuation\">:</span> <span class=\"token class-name\">String</span>\n  <span class=\"token keyword\">var</span> number<span class=\"token punctuation\">:</span> <span class=\"token class-name\">Int</span>\n\n  <span class=\"token keyword\">init</span><span class=\"token punctuation\">(</span>holder<span class=\"token punctuation\">:</span> <span class=\"token class-name\">String</span><span class=\"token punctuation\">,</span> number<span class=\"token punctuation\">:</span> <span class=\"token class-name\">Int</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">self</span><span class=\"token punctuation\">.</span>holder <span class=\"token operator\">=</span> holder\n    <span class=\"token keyword\">self</span><span class=\"token punctuation\">.</span>number <span class=\"token operator\">=</span> number\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">func</span> <span class=\"token function-definition function\">displayBankAccount</span><span class=\"token operator\">&lt;</span><span class=\"token class-name\">T</span><span class=\"token punctuation\">:</span> <span class=\"token class-name\">BankAccount</span><span class=\"token operator\">></span><span class=\"token punctuation\">(</span><span class=\"token keyword\">for</span> account<span class=\"token punctuation\">:</span> <span class=\"token class-name\">T</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-></span> <span class=\"token class-name\">String</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token string-literal\"><span class=\"token string\">\"</span><span class=\"token interpolation-punctuation punctuation\">\\(</span><span class=\"token interpolation\">account<span class=\"token punctuation\">.</span>number</span><span class=\"token interpolation-punctuation punctuation\">)</span><span class=\"token string\"> account belongs to </span><span class=\"token interpolation-punctuation punctuation\">\\(</span><span class=\"token interpolation\">account<span class=\"token punctuation\">.</span>holder</span><span class=\"token interpolation-punctuation punctuation\">)</span><span class=\"token string\">\"</span></span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">var</span> myBankAccount <span class=\"token operator\">=</span> <span class=\"token class-name\">BankAccount</span><span class=\"token punctuation\">(</span>holder<span class=\"token punctuation\">:</span> <span class=\"token string-literal\"><span class=\"token string\">\"Felipe\"</span></span><span class=\"token punctuation\">,</span> number<span class=\"token punctuation\">:</span> <span class=\"token number\">12345678</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token function\">displayBankAccount</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">for</span><span class=\"token punctuation\">:</span> myBankAccount<span class=\"token punctuation\">)</span> <span class=\"token comment\">// 12345678 account belongs to Felipe</span></code></pre></div>\n<p>Da mesma forma que aplicamos esse comportamento nos métodos, também é possível deixar o Swift inferir o tipo de uma <code class=\"language-text\">class</code> ou <code class=\"language-text\">struct</code> e suas propriedades.</p>\n<p>O código genérico permite ao Swift inferir o tipo ou ao desenvolvedor preestabelecer essa informação. A <code class=\"language-text\">struct</code> abaixo pode ser instanciada de duas maneiras:</p>\n<div class=\"gatsby-highlight\" data-language=\"swift\"><pre class=\"language-swift\"><code class=\"language-swift\"><span class=\"token keyword\">struct</span> <span class=\"token class-name\">GenericStruct</span><span class=\"token operator\">&lt;</span><span class=\"token class-name\">T</span><span class=\"token operator\">></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">var</span> property<span class=\"token punctuation\">:</span> <span class=\"token class-name\">T</span><span class=\"token operator\">?</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"swift\"><pre class=\"language-swift\"><code class=\"language-swift\"><span class=\"token keyword\">let</span> explictStruct <span class=\"token operator\">=</span> <span class=\"token class-name\">GenericStruct</span><span class=\"token operator\">&lt;</span><span class=\"token class-name\">Bool</span><span class=\"token operator\">></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>         <span class=\"token comment\">// T is Bool</span>\n<span class=\"token keyword\">let</span> implicitStruct <span class=\"token operator\">=</span> <span class=\"token class-name\">GenericStruct</span><span class=\"token punctuation\">(</span>property<span class=\"token punctuation\">:</span> <span class=\"token number\">10</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\">// T is Int</span></code></pre></div>\n<h3>Conformidade com protocolo</h3>\n<p>No exemplo abaixo estamos restringindo a função <code class=\"language-text\">compareValues()</code> somente para os tipos que conformam com o protocolo <a href=\"https://developer.apple.com/documentation/swift/equatable\">Equatable</a>.</p>\n<div class=\"gatsby-highlight\" data-language=\"swift\"><pre class=\"language-swift\"><code class=\"language-swift\"><span class=\"token keyword\">func</span> <span class=\"token function-definition function\">compareValues</span><span class=\"token operator\">&lt;</span><span class=\"token class-name\">T</span><span class=\"token punctuation\">:</span> <span class=\"token class-name\">Equatable</span><span class=\"token operator\">></span><span class=\"token punctuation\">(</span>between a<span class=\"token punctuation\">:</span> <span class=\"token class-name\">T</span><span class=\"token punctuation\">,</span> and b<span class=\"token punctuation\">:</span> <span class=\"token class-name\">T</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-></span> <span class=\"token class-name\">String</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> a <span class=\"token operator\">==</span> b <span class=\"token operator\">?</span> <span class=\"token string-literal\"><span class=\"token string\">\"They are equals\"</span></span> <span class=\"token punctuation\">:</span> <span class=\"token string-literal\"><span class=\"token string\">\"They aren't equals\"</span></span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token function\">compareValues</span><span class=\"token punctuation\">(</span>between<span class=\"token punctuation\">:</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> and<span class=\"token punctuation\">:</span> <span class=\"token number\">3</span><span class=\"token punctuation\">)</span>         <span class=\"token comment\">// They aren't equals</span>\n<span class=\"token function\">compareValues</span><span class=\"token punctuation\">(</span>between<span class=\"token punctuation\">:</span> <span class=\"token string-literal\"><span class=\"token string\">\"Hi\"</span></span><span class=\"token punctuation\">,</span> and<span class=\"token punctuation\">:</span> <span class=\"token string-literal\"><span class=\"token string\">\"Hi\"</span></span><span class=\"token punctuation\">)</span>   <span class=\"token comment\">// They are equals</span></code></pre></div>\n<h2>Protocolos genéricos</h2>\n<p>Protocolos por si só possibilitam inúmeras implementações, por isso é tão utilizado e difundido entre desenvolvedores <code class=\"language-text\">Swift</code>. E com o uso de <code class=\"language-text\">generics</code>, podemos ampliar ainda mais este conceito. Utilizando a técnica de <code class=\"language-text\">associated type</code> e da cláusula <code class=\"language-text\">where</code> podemos criar protocolos genéricos e fazer restrições por tipo, semelhante aos <code class=\"language-text\">placeholders</code> dos genéricos.</p>\n<p>Visto que, protocolos genéricos fazem uso de <code class=\"language-text\">associated types</code>, este conceito também é conhecido como <code class=\"language-text\">Protocol Associated Types</code> ou <code class=\"language-text\">PATs</code>.</p>\n<h3>Uso convencional de protocolo</h3>\n<p>Antes de aprofundar sobre protocolo genérico, vamos criar um protocolo que nos obriga a adicionar uma propriedade do tipo <code class=\"language-text\">String</code>.</p>\n<p>A criação do protocolo seria dessa maneira:</p>\n<div class=\"gatsby-highlight\" data-language=\"swift\"><pre class=\"language-swift\"><code class=\"language-swift\"><span class=\"token keyword\">protocol</span> <span class=\"token class-name\">MyProtocol</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">var</span> property<span class=\"token punctuation\">:</span> <span class=\"token class-name\">String</span> <span class=\"token punctuation\">{</span> <span class=\"token keyword\">get</span> <span class=\"token keyword\">set</span> <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>E uma classe em conformidade com este protocolo seria assim:</p>\n<div class=\"gatsby-highlight\" data-language=\"swift\"><pre class=\"language-swift\"><code class=\"language-swift\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">MyClass</span><span class=\"token punctuation\">:</span> <span class=\"token class-name\">MyProtocol</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">var</span> property<span class=\"token punctuation\">:</span> <span class=\"token class-name\">String</span> <span class=\"token operator\">=</span> <span class=\"token string-literal\"><span class=\"token string\">\"Property value\"</span></span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Para aplicar o conceito de <code class=\"language-text\">generics</code> na nossa propriedade e permitir informar qualquer outro tipo diferente de <code class=\"language-text\">String</code>, podemos fazer o uso de <code class=\"language-text\">associated types</code>.</p>\n<h3>Protocolos com <code class=\"language-text\">Associated Types</code></h3>\n<p>Em protocolos genéricos, a solução de <code class=\"language-text\">placeholder</code> ou algo como <code class=\"language-text\">&lt;T></code> é relativo à <code class=\"language-text\">associated type</code>:</p>\n<div class=\"gatsby-highlight\" data-language=\"swift\"><pre class=\"language-swift\"><code class=\"language-swift\"><span class=\"token keyword\">protocol</span> <span class=\"token class-name\">MyGenericProtocol</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">associatedtype</span> <span class=\"token class-name\">T</span>\n\n  <span class=\"token keyword\">var</span> property<span class=\"token punctuation\">:</span> <span class=\"token class-name\">T</span> <span class=\"token punctuation\">{</span> <span class=\"token keyword\">get</span> <span class=\"token keyword\">set</span> <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Dessa maneira, para que uma <code class=\"language-text\">class</code> ou <code class=\"language-text\">struct</code> se conforme com o protocolo será necessário, além de implementar a propriedade, definir o seu tipo. Está definição pode ser feita de forma <code class=\"language-text\">implícita</code> ou <code class=\"language-text\">explícita</code>.</p>\n<h4><code class=\"language-text\">Associated Type</code> implícito</h4>\n<p>De forma implícita, ou seja, que fica subentendido pelo compilador:</p>\n<div class=\"gatsby-highlight\" data-language=\"swift\"><pre class=\"language-swift\"><code class=\"language-swift\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">MyClass</span><span class=\"token punctuation\">:</span> <span class=\"token class-name\">MyGenericProtocol</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">var</span> property <span class=\"token operator\">=</span> <span class=\"token boolean\">true</span> <span class=\"token comment\">// T is `Bool`</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h4><code class=\"language-text\">Associated Type</code> explícito</h4>\n<p>De forma explícita, devemos utilizar um <code class=\"language-text\">typealias</code> para especificar o tipo desejado:</p>\n<div class=\"gatsby-highlight\" data-language=\"swift\"><pre class=\"language-swift\"><code class=\"language-swift\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">MyClass</span><span class=\"token punctuation\">:</span> <span class=\"token class-name\">MyGenericProtocol</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">typealias</span> <span class=\"token class-name\">T</span> <span class=\"token operator\">=</span> <span class=\"token class-name\">String</span>\n  <span class=\"token keyword\">var</span> property<span class=\"token punctuation\">:</span> <span class=\"token class-name\">T</span> <span class=\"token operator\">=</span> <span class=\"token string-literal\"><span class=\"token string\">\"My generic property\"</span></span> <span class=\"token comment\">// T is `String`</span>\n<span class=\"token punctuation\">}</span></code></pre></div>","frontmatter":{"title":"Programação genérica","date":"29 outubro, 2020","description":"Nesta postagem abordo o que são códigos genéricos e qual a utilidade na rotina de um desenvolvedor Swift."}},"previous":{"fields":{"slug":"/variacoes-do-nslayoutxaxisanchor/"},"frontmatter":{"title":"Variações do NSLayoutXAxisAnchor"}},"next":{"fields":{"slug":"/pipeline-ios/"},"frontmatter":{"title":"Pipeline de desenvolvimento no Xcode"}}},"pageContext":{"id":"47a1ce81-ce1d-528d-860f-6fe11f99a83f","previousPostId":"ba669320-6c6b-53e1-88ca-a89db95253cd","nextPostId":"87a71028-28b2-5fe6-a3e5-9e913ef8d39b"}},"staticQueryHashes":["1344965497","2841359383"]}